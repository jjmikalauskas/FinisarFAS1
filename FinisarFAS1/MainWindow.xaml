<Window x:Class="FinisarFAS1.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:converters="clr-namespace:FinisarFAS1.Converters"        
        xmlns:progress="clr-namespace:ThreadingComponent"
        xmlns:local="clr-namespace:FinisarFAS1"
        xmlns:view="clr-namespace:FinisarFAS1.View"
        xmlns:vm="clr-namespace:FinisarFAS1.ViewModel"        
        mc:Ignorable="d"  WindowStartupLocation="CenterScreen"
        Loaded="Window_Loaded"
        Closing="Window_Closing" Background="Gray"
        Title="Factory Automation System - Tool: 6-6-EVAP-01" Width="1200" Height="960" >

    <Window.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="View/MainSkin.xaml" />
            </ResourceDictionary.MergedDictionaries>
            <converters:StringToVisibleConverter x:Key="NullVisibilityConverter" />
            <converters:BooleanToVisibleConverter x:Key="BooleanToVisibleConverter" />
            <converters:BooleanToCollapsedConverter x:Key="BooleanToCollapsedConverter" />

            <Storyboard x:Key="expandWafer">
                <Storyboard TargetProperty="RenderTransform.(TranslateTransform.X)">
                    <DoubleAnimation Duration="0:0:0.5"
                                     From="0"
                                     Storyboard.TargetName="waferPanel"
                                     To="1000" />
                </Storyboard>
            </Storyboard>
            <Storyboard x:Key="collapseWafer">
                <Storyboard TargetProperty="RenderTransform.(TranslateTransform.X)">
                    <DoubleAnimation Duration="0:0:0.3"
                                     From="1000"
                                     Storyboard.TargetName="waferPanel"
                                     To="0" />
                </Storyboard>
            </Storyboard>

            <Storyboard x:Key="expandEntry">
                <Storyboard TargetProperty="RenderTransform.(TranslateTransform.X)">
                    <DoubleAnimation Duration="0:0:0.5"
                                     From="0"
                                     Storyboard.TargetName="entryPanel"
                                     To="1000" />
                </Storyboard>
            </Storyboard>
            <Storyboard x:Key="collapseEntry">
                <Storyboard TargetProperty="RenderTransform.(TranslateTransform.X)">
                    <DoubleAnimation Duration="0:0:0.3"
                                     From="1000"
                                     Storyboard.TargetName="entryPanel"
                                     To="0" />
                </Storyboard>
            </Storyboard>

            <Style TargetType="Button">
                <Setter Property="Margin" Value="15,10" />
                <Setter Property="FontSize" Value="28" />
                <Setter Property="Height" Value="50" />
                <Setter Property="Width" Value="140"/>
            </Style>
            
        </ResourceDictionary>
    </Window.Resources>

    <Window.DataContext>
        <vm:MainViewModel></vm:MainViewModel>
    </Window.DataContext>

    <!--<Window.Background>
        <ImageBrush ImageSource="/Images/Blue1.jpg" Opacity="0.9" />
    </Window.Background>-->
    
    <Window.Triggers>
    <EventTrigger RoutedEvent="Window.Loaded">
        <BeginStoryboard>
            <Storyboard>
                <DoubleAnimation Storyboard.TargetProperty="(Window.Opacity)"
                                 From="0.0" To="1.0" Duration="0:0:1"
                                 AutoReverse="False"/>
            </Storyboard>
        </BeginStoryboard>
    </EventTrigger>
</Window.Triggers>

    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="3*" />
            <ColumnDefinition Width="1*" />
        </Grid.ColumnDefinitions>
        <Grid.RowDefinitions>
            <RowDefinition Height="6*" />
            <RowDefinition Height="1*" />
        </Grid.RowDefinitions>
        
        <StackPanel Grid.Row="0" Grid.Column="0" Grid.ColumnSpan="2"
            Margin="0,5,0,0" Background="{DynamicResource ResourceKey=BlueGlass}" Orientation="Vertical">
            <StackPanel Orientation="Horizontal" >
                <StackPanel Margin="2,5" Orientation="Horizontal" >
                    <Label FontSize="18" Content="Operator:"/>
                    <!--<Label Margin="2,0,5,0" FontSize="22" Content="{Binding Path=Operator}" MaxWidth="250" />-->
                    <TextBox Width="250"
                             Text="{Binding Path=Operator, UpdateSourceTrigger=LostFocus}" 
                             KeyUp="TextBox_KeyUp" />
                </StackPanel>
                <StackPanel Margin="2,5" Orientation="Horizontal" >
                    <Label FontSize="18" Content="Tool:" />
                    <TextBox Width="180"
                             Text="{Binding Path=Tool, UpdateSourceTrigger=LostFocus}" KeyUp="TextBox_KeyUp" AcceptsReturn="True" />
                    <!--<Label Margin="2,0,5,0" FontSize="22" Content="{Binding Path=Tool}" MaxWidth="250"/>-->
                </StackPanel>
                <!--<StackPanel Margin="2,5" Orientation="Horizontal" >
                    <Label Content="Lot #" />
                    <Label Margin="2,0,5,0" FontSize="22" Content="{Binding Path=Lot}" />
                </StackPanel>-->
            </StackPanel>            
            <TextBlock Margin="15,2,15,10" TextWrapping="WrapWithOverflow" 
                       FontSize="18"
                       VerticalAlignment="Stretch" 
                       Text="{Binding CurrentRecipe}" />
            <TabControl>
                <TabItem Width="120" Background="LightGray">
                    <TabItem.Header>
                        <Grid Margin="-5,0" Height="31" Width="120" >
                            <!--<ProgressBar Height="31" Width="120" Value="5" Foreground="Lime" />-->
                            <TextBlock Padding="24,6,0,0" Text="{Binding LoadPortNames[0]}" />
                        </Grid>
                    </TabItem.Header>
                    <StackPanel Orientation="Horizontal" >
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="9*" />
                                <ColumnDefinition Width="1*" />
                            </Grid.ColumnDefinitions>
                            <DataGrid x:Name="_mainDataGrid1" 
                                  Grid.Column="0" 
                                  IsReadOnly="True" AutoGenerateColumns="False"
                                  RowHeight="24" FontSize="16" >
                                <DataGrid.RowStyle>
                                    <Style TargetType="DataGridRow">
                                        <Setter Property="Background" Value="{Binding StatusColor}"/>
                                    </Style>
                                </DataGrid.RowStyle>
                                <DataGrid.Columns>
                                    <DataGridTextColumn Width="50"
                                                        Binding="{Binding Slot}"
                                                        Header="Slot" />
                                    <DataGridTextColumn Width="100"
                                                        Binding="{Binding ContainerID}"
                                                        Header="Container ID" />
                                    <DataGridTextColumn Width="130"
                                                        Binding="{Binding WaferNo}"
                                                        Header="Wafer ID" />
                                    <DataGridTextColumn Width="130"
                                                        Binding="{Binding ScribeID}"
                                                        Header="Scribe ID" />                                    
                                    <DataGridTextColumn Width="90"
                                                        Binding="{Binding Product}"
                                                        Header="Product" />
                                    <DataGridTextColumn Width="120" 
                                                        Binding="{Binding Operation}" 
                                                        Header="Operation" />
                                    <DataGridTextColumn Width="145"
                                                        Binding="{Binding Recipe}"
                                                        Header="Recipe" />
                                    <DataGridTextColumn Width="220"
                                                        Binding="{Binding Status}"
                                                        Header="Wafer Status" />
                                </DataGrid.Columns>
                            </DataGrid>
                            <StackPanel Grid.Column="1">
                                <view:RightSideButtonView Height="650" />
                            </StackPanel>
                        </Grid>
                    </StackPanel>
                </TabItem>

                <TabItem  Height="30" Width="120" Background="LightGray" Visibility="{Binding PortBActive, Converter={StaticResource ResourceKey=BooleanToCollapsedConverter}}">
                    <TabItem.Header>
                        <Grid Margin="-5,0" Height="30" Width="120" >
                            <!--<ProgressBar Height="30" Width="120" Value="25" Foreground="Lime" />-->
                            <TextBlock Padding="24,6,0,0" Text="{Binding LoadPortNames[1]}" />
                        </Grid>
                    </TabItem.Header>
                    <StackPanel Orientation="Horizontal" >
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="9*" />
                                <ColumnDefinition Width="1*" />
                            </Grid.ColumnDefinitions>
                            <DataGrid x:Name="_mainDataGrid2" 
                                  Grid.Column="0" 
                                  IsReadOnly="True" AutoGenerateColumns="False"
                                  RowHeight="24" FontSize="16" >
                                <DataGrid.RowStyle>
                                    <Style TargetType="DataGridRow">
                                        <Setter Property="Background" Value="{Binding StatusColor}"/>
                                    </Style>
                                </DataGrid.RowStyle>
                                <DataGrid.Columns>
                                    <DataGridTextColumn Width="50"
                                                        Binding="{Binding Slot}"
                                                        Header="Slot" />
                                    <DataGridTextColumn Width="100"
                                                        Binding="{Binding ContainerID}"
                                                        Header="Container ID" />
                                    <DataGridTextColumn Width="130"
                                                        Binding="{Binding WaferNo}"
                                                        Header="Wafer ID" />
                                    <DataGridTextColumn Width="130"
                                                        Binding="{Binding ScribeID}"
                                                        Header="Scribe ID" />
                                    <DataGridTextColumn Width="90"
                                                        Binding="{Binding Product}"
                                                        Header="Product" />
                                    <DataGridTextColumn Width="120" 
                                                        Binding="{Binding Operation}" 
                                                        Header="Operation" />
                                    <DataGridTextColumn Width="145"
                                                        Binding="{Binding Recipe}"
                                                        Header="Recipe" />
                                    <DataGridTextColumn Width="220"
                                                        Binding="{Binding Status}"
                                                        Header="Wafer Status" />
                                </DataGrid.Columns>
                            </DataGrid>
                            <StackPanel Grid.Column="1">
                                <view:RightSideButtonView Height="700" />
                            </StackPanel>
                        </Grid>
                    </StackPanel>
                </TabItem>

                <TabItem Header="{Binding LoadPortNames[2]}" Visibility="{Binding PortCActive, Converter={StaticResource ResourceKey=BooleanToCollapsedConverter}}" >
                    <Label Content="Load port 3 table" />
                </TabItem>
                <TabItem Header="{Binding LoadPortNames[3]}" Visibility="{Binding PortDActive, Converter={StaticResource ResourceKey=BooleanToCollapsedConverter}}">
                    <Label Content="Load port 4 table" />
                </TabItem>
                          
            </TabControl>            
        </StackPanel>

        <!--<view:RightSideButtonView Grid.Row="0" Grid.Column="1" />-->
        
        <StackPanel Grid.Row="1" Grid.Column="0" Margin="0,0,-42,0" 
                    Background="{DynamicResource ResourceKey=BlueGlass}" Orientation="Vertical">
            <!--<Canvas>
                <Ellipse Canvas.Top="50" Canvas.Left="50"
                  Fill="Red" Height="25" Width="25" />              
            </Canvas>-->
            <TextBlock Margin="5,10,5,5" TextWrapping="WrapWithOverflow" 
                       FontSize="18" Height="28" Background="Red" Padding="8,0,0,0"
                       VerticalAlignment="Stretch" Foreground="White"
                       Text="{Binding CurrentAlarm}" />
            <!--Visibility="Collapsed"-->
            <StackPanel Orientation="Horizontal" Margin="0,15,0,0" >
                <Button ToolTip="Exit FAS program"
                                    Command="{Binding Path=ExitHostCmd}"
                                    Content="Exit Host"  />
                <Button ToolTip="Open up Camstar internal website"
                                    Command="{Binding Path=CamstarCmd}"
                                    Content="Camstar"  />
                <StackPanel Orientation="Horizontal"  Visibility="{Binding TimeToProcess, Converter={StaticResource ResourceKey=BooleanToCollapsedConverter}}" >
                    <Button ToolTip="Alarm listing during current run"
                                    Command="{Binding Path=AlarmListingCmd}"
                                    Content="Alarms"  />
                    <Button ToolTip="Log during current run"
                                    Command="{Binding Path=LogListingCmd}"
                                    Content="Logs"  />
                </StackPanel>
            </StackPanel>
        </StackPanel>

        <StackPanel Grid.Row="1" Grid.Column="1" 
                    Margin="40,0,0,0" VerticalAlignment="Bottom"
                    Background="{DynamicResource ResourceKey=BlueGlass}" Orientation="Vertical">
            <!--Margin="0,0" Background="Transparent" Orientation="Vertical" >-->
            <!--<TextBlock Foreground="White">Statuses</TextBlock>-->
            <StackPanel Margin="20,25,0,5" Orientation="Horizontal">
                <TextBlock FontSize="22"
                    Text="Camstar MES" />
                <!--Foreground="{DynamicResource ResourceKey=GreenGlassText}" />-->
                <Canvas>
                    <Ellipse Canvas.Top="5" Canvas.Left="35"
                             Fill="{Binding CamstarStatusColor}" Height="25" Width="25" />
                </Canvas>
            </StackPanel>
            <StackPanel Margin="20, 15, 0, 5" Orientation="Horizontal">
                <TextBlock FontSize="22"
                    Text="Equipment" />
                <!--</TextBlock>Foreground="{DynamicResource ResourceKey=GreenGlassText}" />-->
                <Canvas>
                    <Ellipse Canvas.Top="5" Canvas.Left="58"
                            Fill="{Binding EquipmentStatusColor}" Height="25" Width="25" />
                </Canvas>
            </StackPanel>
            <StackPanel Margin="15, 10, 5, 0" Orientation="Horizontal">
                <Label Margin="0,0,0,0" FontSize="18" Content="Process State: " VerticalAlignment="Center" />
                <TextBlock FontSize="18" Text="{Binding ProcessState}" VerticalAlignment="Center" />
            </StackPanel>
        </StackPanel>
        

        <!--<StackPanel x:Name="entryPanel" 
                    Grid.Row="0" Grid.RowSpan="2"
                    Grid.Column="0" Grid.ColumnSpan="2"
                    Margin="-1000,0,0,0"
                    HorizontalAlignment="Left">
            <StackPanel.RenderTransform>
                <TranslateTransform />
            </StackPanel.RenderTransform>
            <view:EntryWaferView x:Name="entryView"
                                    Width="1000" Height="800" />
        </StackPanel>-->

        <!--<StackPanel x:Name="waferPanel"
                    Grid.Row="0"
                    Grid.RowSpan="2"
                    Grid.Column="0"
                    Grid.ColumnSpan="2"
                    Margin="-1000,0,0,0"
                    HorizontalAlignment="Left">
            <StackPanel.RenderTransform>
                <TranslateTransform />
            </StackPanel.RenderTransform>
            <view:WaferConfirmationView x:Name="waferView"
                                    Width="1000" />
        </StackPanel>-->
        
        <!--<Viewbox Width="60" 
                             Margin="-380,35,0,0" >
            <progress:CircularProgressBar Visibility="{Binding IsRetrieveBusy, Converter={StaticResource ResourceKey=BooleanToVisibleConverter}}" />
        </Viewbox>-->
    </Grid>
</Window>
